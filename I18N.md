# üåç Internationalization (i18n)

This document explains the internationalization system implementation using i18next and react-i18next.

## üìã Table of Contents

- [Overview](#overview)
- [Features](#features)
- [Setup](#setup)
- [Usage](#usage)
- [Adding New Languages](#adding-new-languages)
- [Translation Keys](#translation-keys)
- [Best Practices](#best-practices)

---

## Overview

The app uses **i18next** and **react-i18next** for internationalization with:

- JSON-based translation files
- Automatic language detection from device settings
- Persistent language preference
- Support for T√ºrk√ße and English

---

## Features

‚úÖ **Automatic Language Detection** - Detects device language on first launch  
‚úÖ **Persistent Storage** - Saves language preference to AsyncStorage  
‚úÖ **JSON Format** - Easy-to-edit translation files  
‚úÖ **Type-Safe** - TypeScript support  
‚úÖ **Fallback System** - Fallback to English if translation missing  
‚úÖ **Development Logging** - Debug mode with detailed logs  
‚úÖ **Hot Reload** - Language changes apply instantly

---

## Setup

### Installation

```bash
npm install i18next react-i18next expo-localization
```

### File Structure

```
i18n/
‚îú‚îÄ‚îÄ index.ts           # i18n configuration
‚îî‚îÄ‚îÄ locales/
    ‚îú‚îÄ‚îÄ en.json       # English translations
    ‚îî‚îÄ‚îÄ tr.json       # Turkish translations
```

---

## Usage

### Basic Usage in Components

```typescript
import { useTranslation } from "react-i18next";

function MyComponent() {
  const { t } = useTranslation();

  return (
    <View>
      <Text>{t("home.title")}</Text>
      <Text>{t("home.subtitle")}</Text>
    </View>
  );
}
```

### With Variables

```typescript
// Translation file
{
  "welcome": "Welcome, {{name}}!"
}

// Component
<Text>{t('welcome', { name: 'John' })}</Text>
// Output: "Welcome, John!"
```

### Pluralization

```typescript
// Translation file
{
  "items": "{{count}} item",
  "items_plural": "{{count}} items"
}

// Component
<Text>{t('items', { count: 1 })}</Text>  // "1 item"
<Text>{t('items', { count: 5 })}</Text>  // "5 items"
```

### Change Language

```typescript
import { changeLanguage } from "../i18n";

// Change to Turkish
await changeLanguage("tr");

// Change to English
await changeLanguage("en");
```

### Get Current Language

```typescript
import { getCurrentLanguage } from "../i18n";

const currentLang = getCurrentLanguage(); // 'en' or 'tr'
```

### Language Switcher Component

```typescript
import LanguageSwitcher from "../components/LanguageSwitcher";

function SettingsScreen() {
  return (
    <View>
      <LanguageSwitcher />
    </View>
  );
}
```

---

## Adding New Languages

### 1. Create Translation File

Create `i18n/locales/fr.json`:

```json
{
  "common": {
    "loading": "Chargement...",
    "error": "Erreur",
    "success": "Succ√®s"
  },
  "home": {
    "title": "Accueil",
    "subtitle": "Bienvenue"
  }
}
```

### 2. Update i18n Configuration

Edit `i18n/index.ts`:

```typescript
import fr from "./locales/fr.json";

// Add to languages array
export const languages = [
  { code: "en", name: "English", flag: "üá¨üáß", nativeName: "English" },
  { code: "tr", name: "T√ºrk√ße", flag: "üáπüá∑", nativeName: "T√ºrk√ße" },
  { code: "fr", name: "Fran√ßais", flag: "üá´üá∑", nativeName: "Fran√ßais" },
];

// Add to resources
i18n.init({
  resources: {
    en: { translation: en },
    tr: { translation: tr },
    fr: { translation: fr },
  },
  // ...
});
```

---

## Translation Keys

### Current Translation Structure

```
common          - Common UI strings (buttons, actions)
navigation      - Tab and navigation labels
home            - Home screen
tasks           - Tasks screen
api             - API demo screen
auth            - Authentication screen
profile         - Profile screen
errors          - Error messages
```

### Example Keys

```json
{
  "common": {
    "loading": "Loading...",
    "error": "Error",
    "save": "Save",
    "delete": "Delete"
  },
  "home": {
    "title": "Home Screen",
    "features": "Features",
    "featureList": {
      "zustand": "Zustand State Management"
    }
  }
}
```

---

## Best Practices

### 1. Use Namespaced Keys

```typescript
// ‚úÖ Good
t("home.title");
t("common.loading");

// ‚ùå Bad
t("title");
t("loading");
```

### 2. Keep Keys Descriptive

```typescript
// ‚úÖ Good
t("tasks.deleteConfirm");
t("profile.resetMessage");

// ‚ùå Bad
t("msg1");
t("text2");
```

### 3. Use Nested Objects

```json
// ‚úÖ Good
{
  "home": {
    "features": {
      "title": "Features",
      "list": {
        "item1": "State Management",
        "item2": "Navigation"
      }
    }
  }
}

// ‚ùå Bad
{
  "home_features_title": "Features",
  "home_features_list_item1": "State Management"
}
```

### 4. Extract All Text

```typescript
// ‚úÖ Good
<Text>{t('common.loading')}</Text>

// ‚ùå Bad
<Text>Loading...</Text>
```

### 5. Use Default Values

```typescript
// Provide fallback
t("unknown.key", "Default text");
```

### 6. Avoid Dynamic Keys

```typescript
// ‚ùå Bad
t(`home.${dynamicKey}`);

// ‚úÖ Good
const translations = {
  option1: t("home.option1"),
  option2: t("home.option2"),
};
translations[dynamicKey];
```

---

## Auto-Detection Logic

The app detects language in this order:

1. **Saved Preference** - Check AsyncStorage for saved language
2. **Device Language** - Get device's primary language
3. **Base Language** - Try base language (e.g., 'en-US' ‚Üí 'en')
4. **Fallback** - Use English if no match found

### Example

```
Device Language: 'en-US'
‚Üí Check: 'en-US' supported? No
‚Üí Check: 'en' supported? Yes
‚Üí Use: 'en'
```

---

## Development Logging

In development mode, i18n logs useful information:

```
üåç i18n initialized with languages: en, tr
üåê Device locales: tr, en
üåê Auto-detected language: tr
üíæ Language saved: tr
üåê Language changed to: en
```

To disable debug logs:

```typescript
i18n.init({
  debug: false,
  // ...
});
```

---

## API Reference

### useTranslation Hook

```typescript
const { t, i18n } = useTranslation();

// Translate
t("key");

// With variables
t("key", { variable: "value" });

// Current language
i18n.language;

// Change language
i18n.changeLanguage("tr");
```

### Helper Functions

```typescript
import {
  changeLanguage,
  getCurrentLanguage,
  isLanguageSupported,
  languages,
} from "../i18n";

// Change language
await changeLanguage("tr");

// Get current language
const lang = getCurrentLanguage(); // 'en' | 'tr'

// Check if language is supported
isLanguageSupported("fr"); // false

// Get all languages
languages.forEach((lang) => {
  console.log(lang.code, lang.name, lang.flag);
});
```

---

## Troubleshooting

### Translations not updating

1. Restart development server
2. Clear Metro bundler cache: `npx expo start --clear`
3. Check JSON syntax in locale files

### Language not detected

1. Check device language in settings
2. Verify language code in `languages` array
3. Check AsyncStorage for saved language

### TypeScript errors with JSON

Ensure `tsconfig.json` has:

```json
{
  "compilerOptions": {
    "resolveJsonModule": true
  }
}
```

### Missing translations

- Use fallback values: `t('key', 'Default')`
- Check console for missing key warnings
- Ensure key exists in all locale files

---

## Related Documentation

- [Environment Setup](./ENV_SETUP.md)
- [Version Control](./VERSION_CONTROL.md)
- [Error Handling](./ERROR_HANDLING.md)

---

## Resources

- [i18next Documentation](https://www.i18next.com/)
- [react-i18next Documentation](https://react.i18next.com/)
- [Expo Localization](https://docs.expo.dev/versions/latest/sdk/localization/)
